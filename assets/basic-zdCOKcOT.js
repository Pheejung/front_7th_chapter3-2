import{r as m,j as e,a as E,R as O}from"./client-BdDDBfAG.js";const F=({cart:t,isAdmin:s,onAdminToggle:n,searchTerm:a,onSearchChange:r})=>{const l=m.useMemo(()=>t.reduce((i,d)=>i+d.quantity,0),[t]);return e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-40 border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"flex justify-between items-center h-16",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"SHOP"}),!s&&e.jsx("div",{className:"ml-8 flex-1 max-w-md",children:e.jsx("input",{type:"text",value:a,onChange:i=>r(i.target.value),placeholder:"상품 검색...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500"})})]}),e.jsxs("nav",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:n,className:`px-3 py-1.5 text-sm rounded transition-colors ${s?"bg-gray-800 text-white":"text-gray-600 hover:text-gray-900"}`,children:s?"쇼핑몰로 돌아가기":"관리자 페이지로"}),!s&&e.jsxs("div",{className:"relative",children:[e.jsx("svg",{className:"w-6 h-6 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),t.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l})]})]})]})})})},H=t=>t<0?{isValid:!1,errorMessage:"가격은 0보다 커야 합니다"}:t>1e7?{isValid:!1,errorMessage:"가격은 10,000,000원을 초과할 수 없습니다"}:{isValid:!0},W=t=>t<0?{isValid:!1,errorMessage:"재고는 0보다 커야 합니다"}:t>9999?{isValid:!1,errorMessage:"재고는 9999개를 초과할 수 없습니다"}:{isValid:!0},z=t=>t<0?{isValid:!1,errorMessage:"할인율은 0% 이상이어야 합니다"}:t>100?{isValid:!1,errorMessage:"할인율은 100%를 초과할 수 없습니다"}:{isValid:!0},U=t=>t<0?{isValid:!1,errorMessage:"할인 금액은 0원 이상이어야 합니다"}:t>1e5?{isValid:!1,errorMessage:"할인 금액은 100,000원을 초과할 수 없습니다"}:{isValid:!0},M=t=>/^\d+$/.test(t),T=(t,s=0)=>{if(t==="")return s;const n=parseInt(t);return isNaN(n)?s:n},V=({className:t="w-4 h-4"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),D=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),J=({className:t="w-24 h-24"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Q=({className:t="w-8 h-8"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),_=({className:t="w-5 h-5"})=>e.jsx("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),G=({className:t="text-xs"})=>e.jsx("span",{className:t,children:"−"}),K=({className:t="text-xs"})=>e.jsx("span",{className:t,children:"+"}),X=({products:t,coupons:s,onAddProduct:n,onUpdateProduct:a,onDeleteProduct:r,onAddCoupon:l,onDeleteCoupon:i,formatPrice:d,onNotify:x})=>{const[b,u]=m.useState("products"),[C,N]=m.useState(!1),[w,v]=m.useState(null),[c,h]=m.useState({name:"",price:0,stock:0,description:"",discounts:[]}),[y,f]=m.useState(!1),[g,k]=m.useState({name:"",code:"",discountType:"amount",discountValue:0}),$=o=>{o.preventDefault(),w&&w!=="new"?a(w,c):n(c),h({name:"",price:0,stock:0,description:"",discounts:[]}),v(null),N(!1)},I=o=>{o.preventDefault(),l(g),k({name:"",code:"",discountType:"amount",discountValue:0}),f(!1)},R=o=>{v(o.id),h({name:o.name,price:o.price,stock:o.stock,description:o.description||"",discounts:o.discounts||[]}),N(!0)};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"관리자 대시보드"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"상품과 쿠폰을 관리할 수 있습니다"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>u("products"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${b==="products"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"상품 관리"}),e.jsx("button",{onClick:()=>u("coupons"),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${b==="coupons"?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"쿠폰 관리"})]})}),b==="products"&&e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"상품 목록"}),e.jsx("button",{onClick:()=>{v("new"),h({name:"",price:0,stock:0,description:"",discounts:[]}),N(!0)},className:"px-4 py-2 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800",children:"새 상품 추가"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상품명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가격"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"재고"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설명"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d(o.price,o.id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.stock>10?"bg-green-100 text-green-800":o.stock>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[o.stock,"개"]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:o.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>R(o),className:"text-indigo-600 hover:text-indigo-900 mr-3",children:"수정"}),e.jsx("button",{onClick:()=>r(o.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})]},o.id))})]})}),C&&e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50",children:e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:w==="new"?"새 상품 추가":"상품 수정"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상품명"}),e.jsx("input",{type:"text",value:c.name,onChange:o=>h({...c,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),e.jsx("input",{type:"text",value:c.description,onChange:o=>h({...c,description:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"가격"}),e.jsx("input",{type:"text",value:c.price===0?"":c.price,onChange:o=>{const p=o.target.value;(p===""||M(p))&&h({...c,price:T(p,0)})},onBlur:o=>{const p=T(o.target.value,0),j=H(p);j.isValid||(x(j.errorMessage,"error"),h({...c,price:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"재고"}),e.jsx("input",{type:"text",value:c.stock===0?"":c.stock,onChange:o=>{const p=o.target.value;(p===""||M(p))&&h({...c,stock:T(p,0)})},onBlur:o=>{const p=T(o.target.value,0),j=W(p);j.isValid||(x(j.errorMessage,"error"),h({...c,stock:0}))},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border",placeholder:"숫자만 입력",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"할인 정책"}),e.jsxs("div",{className:"space-y-2",children:[c.discounts.map((o,p)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded",children:[e.jsx("input",{type:"number",value:o.quantity,onChange:j=>{const S=[...c.discounts];S[p].quantity=parseInt(j.target.value)||0,h({...c,discounts:S})},className:"w-20 px-2 py-1 border rounded",min:"1",placeholder:"수량"}),e.jsx("span",{className:"text-sm",children:"개 이상 구매 시"}),e.jsx("input",{type:"number",value:o.rate*100,onChange:j=>{const S=[...c.discounts];S[p].rate=(parseInt(j.target.value)||0)/100,h({...c,discounts:S})},className:"w-16 px-2 py-1 border rounded",min:"0",max:"100",placeholder:"%"}),e.jsx("span",{className:"text-sm",children:"% 할인"}),e.jsx("button",{type:"button",onClick:()=>{const j=c.discounts.filter((S,B)=>B!==p);h({...c,discounts:j})},className:"text-red-600 hover:text-red-800",children:e.jsx(V,{})})]},p)),e.jsx("button",{type:"button",onClick:()=>{h({...c,discounts:[...c.discounts,{quantity:10,rate:.1}]})},className:"text-sm text-indigo-600 hover:text-indigo-800",children:"+ 할인 추가"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{v(null),h({name:"",price:0,stock:0,description:"",discounts:[]}),N(!1)},className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:w==="new"?"추가":"수정"})]})]})})]}),b==="coupons"&&e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold",children:"쿠폰 관리"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[s.map(o=>e.jsx("div",{className:"relative bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-4 border border-indigo-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:o.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 font-mono",children:o.code}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-white text-indigo-700",children:o.discountType==="amount"?`${o.discountValue.toLocaleString()}원 할인`:`${o.discountValue}% 할인`})})]}),e.jsx("button",{onClick:()=>i(o.code),className:"text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(_,{})})]})},o.code)),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center hover:border-gray-400 transition-colors",children:e.jsxs("button",{onClick:()=>f(!y),className:"text-gray-400 hover:text-gray-600 flex flex-col items-center",children:[e.jsx(Q,{}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"새 쿠폰 추가"})]})})]}),y&&e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsx("h3",{className:"text-md font-medium text-gray-900",children:"새 쿠폰 생성"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰명"}),e.jsx("input",{type:"text",value:g.name,onChange:o=>k({...g,name:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:"신규 가입 쿠폰",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"쿠폰 코드"}),e.jsx("input",{type:"text",value:g.code,onChange:o=>k({...g,code:o.target.value.toUpperCase()}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm font-mono",placeholder:"WELCOME2024",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"할인 타입"}),e.jsxs("select",{value:g.discountType,onChange:o=>k({...g,discountType:o.target.value}),className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",children:[e.jsx("option",{value:"amount",children:"정액 할인"}),e.jsx("option",{value:"percentage",children:"정률 할인"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:g.discountType==="amount"?"할인 금액":"할인율(%)"}),e.jsx("input",{type:"text",value:g.discountValue===0?"":g.discountValue,onChange:o=>{const p=o.target.value;(p===""||M(p))&&k({...g,discountValue:T(p,0)})},onBlur:o=>{const p=T(o.target.value,0);if(g.discountType==="percentage"){const j=z(p);j.isValid||(x(j.errorMessage,"error"),k({...g,discountValue:0}))}else{const j=U(p);j.isValid||(x(j.errorMessage,"error"),k({...g,discountValue:0}))}},className:"w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 px-3 py-2 border text-sm",placeholder:g.discountType==="amount"?"5000":"10",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"취소"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"쿠폰 생성"})]})]})})]})]})]})},Y=({product:t,onAddToCart:s,formatPrice:n,getRemainingStock:a})=>{const r=a(t),l=t.discounts.length>0?Math.max(...t.discounts.map(i=>i.rate)):0;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 flex items-center justify-center",children:e.jsx(J,{className:"w-24 h-24 text-gray-300"})}),t.isRecommended&&e.jsx("span",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded",children:"BEST"}),t.discounts.length>0&&e.jsxs("span",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-1 rounded",children:["~",l*100,"%"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:t.name}),t.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:t.description}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:n(t.price,t.id)}),t.discounts.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:[t.discounts[0].quantity,"개 이상 구매시 할인 ",t.discounts[0].rate*100,"%"]})]}),e.jsxs("div",{className:"mb-3",children:[r<=5&&r>0&&e.jsxs("p",{className:"text-xs text-red-600 font-medium",children:["품절임박! ",r,"개 남음"]}),r>5&&e.jsxs("p",{className:"text-xs text-gray-500",children:["재고 ",r,"개"]})]}),e.jsx("button",{onClick:()=>s(t),disabled:r<=0,className:`w-full py-2 px-4 rounded-md font-medium transition-colors ${r<=0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-900 text-white hover:bg-gray-800"}`,children:r<=0?"품절":"장바구니 담기"})]})]})},Z=({products:t,searchTerm:s,onAddToCart:n,formatPrice:a,getRemainingStock:r})=>e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"전체 상품"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",t.length,"개 상품"]})]}),t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:['"',s,'"에 대한 검색 결과가 없습니다.']})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>e.jsx(Y,{product:l,onAddToCart:n,formatPrice:a,getRemainingStock:r},l.id))})]}),ee=({item:t,onRemove:s,onUpdateQuantity:n,calculateItemTotal:a})=>{const r=a(t),l=t.product.price*t.quantity,i=r<l,d=i?Math.round((1-r/l)*100):0;return e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 flex-1",children:t.product.name}),e.jsx("button",{onClick:()=>s(t.product.id),className:"text-gray-400 hover:text-red-500 ml-2",children:e.jsx(V,{})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>n(t.product.id,t.quantity-1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx(G,{})}),e.jsx("span",{className:"mx-3 text-sm font-medium w-8 text-center",children:t.quantity}),e.jsx("button",{onClick:()=>n(t.product.id,t.quantity+1),className:"w-6 h-6 rounded border border-gray-300 flex items-center justify-center hover:bg-gray-100",children:e.jsx(K,{})})]}),e.jsxs("div",{className:"text-right",children:[i&&e.jsxs("span",{className:"text-xs text-red-500 font-medium block",children:["-",d,"%"]}),e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[Math.round(r).toLocaleString(),"원"]})]})]})]})},te=({coupons:t,selectedCoupon:s,onApply:n,onRemove:a})=>e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700",children:"쿠폰 할인"}),e.jsx("button",{className:"text-xs text-blue-600 hover:underline",children:"쿠폰 등록"})]}),t.length>0&&e.jsxs("select",{className:"w-full text-sm border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-blue-500",value:s?.code||"",onChange:r=>{const l=t.find(i=>i.code===r.target.value);l?n(l):a()},children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map(r=>e.jsxs("option",{value:r.code,children:[r.name," (",r.discountType==="amount"?`${r.discountValue.toLocaleString()}원`:`${r.discountValue}%`,")"]},r.code))]})]}),se=({cart:t,coupons:s,selectedCoupon:n,onRemoveFromCart:a,onUpdateQuantity:r,onApplyCoupon:l,onRemoveCoupon:i,onCompleteOrder:d,calculateItemTotal:x,calculateCartTotal:b})=>{const u=b();return e.jsxs("div",{className:"sticky top-24 space-y-4",children:[e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(D,{className:"w-5 h-5 mr-2"}),"장바구니"]}),t.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(D,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"장바구니가 비어있습니다"})]}):e.jsx("div",{className:"space-y-3",children:t.map(C=>e.jsx(ee,{item:C,onRemove:a,onUpdateQuantity:r,calculateItemTotal:x},C.product.id))})]}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(te,{coupons:s,selectedCoupon:n,onApply:l,onRemove:i}),e.jsxs("section",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"결제 정보"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"상품 금액"}),e.jsxs("span",{className:"font-medium",children:[u.totalBeforeDiscount.toLocaleString(),"원"]})]}),u.totalBeforeDiscount-u.totalAfterDiscount>0&&e.jsxs("div",{className:"flex justify-between text-red-500",children:[e.jsx("span",{children:"할인 금액"}),e.jsxs("span",{children:["-",(u.totalBeforeDiscount-u.totalAfterDiscount).toLocaleString(),"원"]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-t border-gray-200",children:[e.jsx("span",{className:"font-semibold",children:"결제 예정 금액"}),e.jsxs("span",{className:"font-bold text-lg text-gray-900",children:[u.totalAfterDiscount.toLocaleString(),"원"]})]})]}),e.jsxs("button",{onClick:d,className:"w-full mt-4 py-3 bg-yellow-400 text-gray-900 rounded-md font-medium hover:bg-yellow-500 transition-colors",children:[u.totalAfterDiscount.toLocaleString(),"원 결제하기"]}),e.jsx("div",{className:"mt-3 text-xs text-gray-500 text-center",children:e.jsx("p",{children:"* 실제 결제는 이루어지지 않습니다"})})]})]})]})},re=({products:t,cart:s,coupons:n,selectedCoupon:a,searchTerm:r,onAddToCart:l,onRemoveFromCart:i,onUpdateQuantity:d,onApplyCoupon:x,onRemoveCoupon:b,onCompleteOrder:u,formatPrice:C,getRemainingStock:N,calculateItemTotal:w,calculateCartTotal:v})=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsx(Z,{products:t,searchTerm:r,onAddToCart:l,formatPrice:C,getRemainingStock:N})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsx(se,{cart:s,coupons:n,selectedCoupon:a,onRemoveFromCart:i,onUpdateQuantity:d,onApplyCoupon:x,onRemoveCoupon:b,onCompleteOrder:u,calculateItemTotal:w,calculateCartTotal:v})})]}),P=(t,s)=>{const n=s.find(r=>r.product.id===t.id);return t.stock-(n?.quantity||0)},ne=(t,s)=>{if(!s)return t;const n=s.toLowerCase();return t.filter(a=>{const r=a.name.toLowerCase().includes(n),l="description"in a&&typeof a.description=="string"&&a.description.toLowerCase().includes(n);return r||l})},ae=(t,s,n,a)=>n&&a&&P(n,a)<=0?"SOLD OUT":s?`${t.toLocaleString()}원`:`₩${t.toLocaleString()}`,oe=()=>`ORD-${Date.now()}`,ce=(t,s=500)=>{const[n,a]=m.useState(t);return m.useEffect(()=>{const r=setTimeout(()=>{a(t)},s);return()=>{clearTimeout(r)}},[t,s]),n},ie=()=>{const[t,s]=m.useState([]),n=m.useCallback((r,l="success")=>{const i=Date.now().toString();s(d=>[...d,{id:i,message:r,type:l}]),setTimeout(()=>{s(d=>d.filter(x=>x.id!==i))},3e3)},[]),a=m.useCallback(r=>{s(l=>l.filter(i=>i.id!==r))},[]);return{toasts:t,addToast:n,removeToast:a}},le=(t,s)=>{const{discounts:n}=t.product,{quantity:a}=t,r=n.reduce((i,d)=>a>=d.quantity&&d.rate>i?d.rate:i,0);return s.some(i=>i.quantity>=10)?Math.min(r+.05,.5):r},A=(t,s)=>{const{price:n}=t.product,{quantity:a}=t,r=le(t,s);return Math.round(n*a*(1-r))},q=(t,s)=>{let n=0,a=0;return t.forEach(r=>{const l=r.product.price*r.quantity;n+=l,a+=A(r,t)}),s&&(s.discountType==="amount"?a=Math.max(0,a-s.discountValue):a=Math.round(a*(1-s.discountValue/100))),{totalBeforeDiscount:Math.round(n),totalAfterDiscount:Math.round(a)}},de=(t,s)=>t.discountType==="percentage"&&s<1e4?{canApply:!1,reason:"percentage 쿠폰은 10,000원 이상 구매 시 사용 가능합니다."}:{canApply:!0},ue=(t,s)=>t.some(n=>n.code===s),L=(t,s)=>{const[n,a]=m.useState(()=>{try{const r=window.localStorage.getItem(t);return r?JSON.parse(r):s}catch(r){return console.error(`Error loading ${t} from localStorage:`,r),s}});return m.useEffect(()=>{try{window.localStorage.setItem(t,JSON.stringify(n))}catch(r){console.error(`Error saving ${t} to localStorage:`,r)}},[t,n]),[n,a]},me=({products:t,onNotify:s})=>{const[n,a]=L("cart",[]),[r,l]=m.useState(null),i=m.useCallback(c=>{if(P(c,n)<=0){s("재고가 부족합니다!","error");return}a(y=>{const f=y.find(g=>g.product.id===c.id);return f&&f.quantity+1>c.stock?(s(`재고는 ${c.stock}개까지만 있습니다.`,"error"),y):f?y.map(g=>g.product.id===c.id?{...g,quantity:g.quantity+1}:g):[...y,{product:c,quantity:1}]}),s("장바구니에 담았습니다","success")},[n,s,a]),d=m.useCallback(c=>{a(h=>h.filter(y=>y.product.id!==c))},[a]),x=m.useCallback((c,h)=>{if(h<=0){d(c);return}const y=t.find(g=>g.id===c);if(!y)return;const f=y.stock;if(h>f){s(`재고는 ${f}개까지만 있습니다.`,"error");return}a(g=>g.map(k=>k.product.id===c?{...k,quantity:h}:k))},[t,d,s,a]),b=m.useCallback(c=>{const h=q(n,r).totalAfterDiscount,{canApply:y,reason:f}=de(c,h);if(!y&&f){s(f,"error");return}l(c),s("쿠폰이 적용되었습니다.","success")},[n,r,s]),u=m.useCallback(()=>{l(null)},[]),C=m.useCallback(()=>{const c=oe();s(`주문이 완료되었습니다. 주문번호: ${c}`,"success"),a([]),l(null)},[s,a]),N=m.useCallback(c=>P(c,n),[n]),w=m.useCallback(c=>A(c,n),[n]),v=m.useMemo(()=>q(n,r),[n,r]);return{cart:n,selectedCoupon:r,addToCart:i,removeFromCart:d,updateQuantity:x,applyCoupon:b,removeCoupon:u,completeOrder:C,getRemainingStock:N,calculateItemTotal:w,totals:v}},xe=({initialProducts:t,onNotify:s})=>{const[n,a]=L("products",t),r=m.useCallback(d=>{const x={...d,id:`p${Date.now()}`};a(b=>[...b,x]),s("상품이 추가되었습니다.","success")},[s,a]),l=m.useCallback((d,x)=>{a(b=>b.map(u=>u.id===d?{...u,...x}:u)),s("상품이 수정되었습니다.","success")},[s,a]),i=m.useCallback(d=>{a(x=>x.filter(b=>b.id!==d)),s("상품이 삭제되었습니다.","success")},[s,a]);return{products:n,addProduct:r,updateProduct:l,deleteProduct:i}},ge=({initialCoupons:t,onNotify:s})=>{const[n,a]=L("coupons",t),r=m.useCallback(i=>{if(ue(n,i.code)){s("이미 존재하는 쿠폰 코드입니다.","error");return}a(d=>[...d,i]),s("쿠폰이 추가되었습니다.","success")},[n,s,a]),l=m.useCallback(i=>{a(d=>d.filter(x=>x.code!==i)),s("쿠폰이 삭제되었습니다.","success")},[s,a]);return{coupons:n,addCoupon:r,deleteCoupon:l}},he=({id:t,message:s,type:n,onClose:a})=>{const r=n==="error"?"bg-red-600":n==="warning"?"bg-yellow-600":"bg-green-600";return e.jsxs("div",{className:`${r} p-4 rounded-md shadow-md text-white flex justify-between items-center animate-slide-in`,role:"alert",children:[e.jsx("span",{className:"mr-2",children:s}),e.jsx("button",{onClick:()=>a(t),className:"text-white hover:text-gray-200 transition-colors","aria-label":"알림 닫기",children:e.jsx(V,{})})]})},pe=({toasts:t,onClose:s})=>t.length===0?null:e.jsx("div",{className:"fixed top-20 right-4 z-50 space-y-2 max-w-sm",children:t.map(n=>e.jsx(he,{...n,onClose:s},n.id))}),be=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}],description:"최고급 품질의 프리미엄 상품입니다."},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}],description:"다양한 기능을 갖춘 실용적인 상품입니다.",isRecommended:!0},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2},{quantity:30,rate:.25}],description:"대용량과 고성능을 자랑하는 상품입니다."}],je=[{name:"5000원 할인",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인",code:"PERCENT10",discountType:"percentage",discountValue:10}],ye=()=>{const[t,s]=m.useState(!1),[n,a]=m.useState(""),r=ce(n,500),{toasts:l,addToast:i,removeToast:d}=ie(),x=xe({initialProducts:be,onNotify:i}),b=ge({initialCoupons:je,onNotify:i}),u=me({products:x.products,onNotify:i}),C=m.useMemo(()=>ne(x.products,r),[x.products,r]),N=(v,c)=>ae(v,t,c?x.products.find(h=>h.id===c):void 0,u.cart),w=()=>u.totals;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(pe,{toasts:l,onClose:d}),e.jsx(F,{cart:u.cart,isAdmin:t,onAdminToggle:()=>s(v=>!v),searchTerm:n,onSearchChange:a}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:t?e.jsx(X,{products:x.products,coupons:b.coupons,onAddProduct:x.addProduct,onUpdateProduct:x.updateProduct,onDeleteProduct:x.deleteProduct,onAddCoupon:b.addCoupon,onDeleteCoupon:b.deleteCoupon,formatPrice:N,onNotify:i}):e.jsx(re,{products:C,cart:u.cart,coupons:b.coupons,selectedCoupon:u.selectedCoupon,searchTerm:r,onAddToCart:u.addToCart,onRemoveFromCart:u.removeFromCart,onUpdateQuantity:u.updateQuantity,onApplyCoupon:u.applyCoupon,onRemoveCoupon:u.removeCoupon,onCompleteOrder:u.completeOrder,formatPrice:N,getRemainingStock:u.getRemainingStock,calculateItemTotal:u.calculateItemTotal,calculateCartTotal:w})})]})};E.createRoot(document.getElementById("root")).render(e.jsx(O.StrictMode,{children:e.jsx(ye,{})}));
